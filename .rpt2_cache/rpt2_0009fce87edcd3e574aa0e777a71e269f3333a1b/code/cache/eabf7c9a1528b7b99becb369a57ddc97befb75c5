{
  "code": "import PlayerDataMgr from \"../Libs/PlayerDataMgr\";\r\nimport TimeCountMgr from \"../Libs/TimeCountMgr\";\r\nimport JJMgr, { SceneDir } from \"../JJExport/Common/JJMgr\";\r\nimport GameLogic from \"../Crl/GameLogic\";\r\nimport Utility from \"../Mod/Utility\";\r\nimport WxApi from \"../Libs/WxApi\";\r\nexport default class GameTopNode extends Laya.Script {\r\n    constructor() {\r\n        super();\r\n        this.navIndex = 0;\r\n    }\r\n    onEnable() {\r\n        GameTopNode.Share = this;\r\n        this.calculateTime();\r\n        Laya.timer.loop(1000, this, this.calculateTime);\r\n        this.initData();\r\n        this.initNavItem();\r\n        Laya.timer.loop(3000, this, this.initNavItem);\r\n        Utility.rotateLoop(this.navItem, 10, 400);\r\n    }\r\n    initData() {\r\n        this.coinNum.value = PlayerDataMgr.getPlayerData().coin.toString();\r\n        this.powerNum.value = PlayerDataMgr.getPlayerData().power.toString();\r\n        this.gradeNum.text = PlayerDataMgr.getPlayerData().grade.toString();\r\n        this.bar.width = (PlayerDataMgr.getPlayerData().gradeIndex + 1) / 4 * 480;\r\n        this.bossPic.visible = this.bar.width >= 480;\r\n        let g = Math.floor(PlayerDataMgr.getPlayerData().grade % 4) == 0 ? 4 : Math.floor(PlayerDataMgr.getPlayerData().grade % 4);\r\n        for (let i = 0; i < this.keyNode.numChildren; i++) {\r\n            let key = this.keyNode.getChildAt(i);\r\n            key.skin = g > i + 1 ? 'mainUI/sy-ys1.png' : 'mainUI/sy-ys2.png';\r\n        }\r\n    }\r\n    onDisable() {\r\n        Laya.timer.clearAll(this);\r\n    }\r\n    calculateTime() {\r\n        let t = TimeCountMgr.Share.tCount;\r\n        let m = Math.floor(t / 60);\r\n        let s = Math.floor(t - m * 60);\r\n        this.powerTime.text = m.toString() + ':' + s.toString();\r\n        this.powerNum.value = PlayerDataMgr.getPlayerData().power.toString();\r\n        this.powerTime.visible = PlayerDataMgr.getPlayerData().power < 10;\r\n    }\r\n    initNavItem() {\r\n        let id = this.navIndex;\r\n        let icon = this.navItem.getChildAt(0);\r\n        icon.skin = JJMgr.instance.navDataArr[id].icon;\r\n        icon.off(Laya.Event.CLICK, this, this.navCB);\r\n        icon.on(Laya.Event.CLICK, this, this.navCB, [id]);\r\n        this.navIndex++;\r\n        if (this.navIndex >= JJMgr.instance.navDataArr.length)\r\n            this.navIndex = 0;\r\n    }\r\n    navCB(index) {\r\n        WxApi.aldEvent('首页导出位-总点击数');\r\n        JJMgr.instance.NavigateApp(index, () => {\r\n            GameLogic.Share.pauseGame = true;\r\n            JJMgr.instance.openScene(SceneDir.SCENE_RECOMMENDUI, false, {\r\n                closeCallbackFun: () => {\r\n                    GameLogic.Share.pauseGame = false;\r\n                }\r\n            });\r\n        }, () => {\r\n            WxApi.aldEvent('首页导出位-总成功跳转数');\r\n        });\r\n    }\r\n}\r\n",
  "references": [
    "E:/GitProjects/DrawWeapon/src/Libs/PlayerDataMgr.ts",
    "E:/GitProjects/DrawWeapon/src/Libs/TimeCountMgr.ts",
    "E:/GitProjects/DrawWeapon/src/JJExport/Common/JJMgr.ts",
    "E:/GitProjects/DrawWeapon/src/Crl/GameLogic.ts",
    "E:/GitProjects/DrawWeapon/src/Mod/Utility.ts",
    "E:/GitProjects/DrawWeapon/src/Libs/WxApi.ts"
  ]
}
